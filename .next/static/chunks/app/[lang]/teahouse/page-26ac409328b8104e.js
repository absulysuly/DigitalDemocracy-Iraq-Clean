(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[354],{32595:function(e,t,r){Promise.resolve().then(r.bind(r,1096))},1096:function(e,t,r){"use strict";r.d(t,{default:function(){return h}});var n=r(57437),o=r(2265),i=r(48614),a=r(40521),s=e=>{let{title:t,subtitle:r}=e;return(0,n.jsxs)(a.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-iraq-red via-iraq-white to-iraq-green p-8 rounded-2xl text-center my-6",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2 font-arabic",style:{textShadow:"1px 1px 2px rgba(0,0,0,0.1)"},children:t}),(0,n.jsx)("p",{className:"text-gray-700",children:r})]})},l=r(79205);let c=(0,l.Z)("mic-off",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]]),u=(0,l.Z)("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]);var d=r(40257);async function f(e,t,r,n){let o=new Int16Array(e.buffer),i=o.length/n,a=t.createBuffer(n,i,r);for(let e=0;e<n;e++){let t=a.getChannelData(e);for(let r=0;r<i;r++)t[r]=o[r*n+e]/32768}return a}function h(e){let{dictionary:t}=e,[r,l]=(0,o.useState)("disconnected"),[h,p]=(0,o.useState)([]),[m,g]=(0,o.useState)(!1),v=(0,o.useRef)(null),x=(0,o.useRef)(null),y=(0,o.useRef)(null),w=(0,o.useRef)(null),b=(0,o.useRef)(new Set).current,k=0;(0,o.useEffect)(()=>{d.env.NEXT_PUBLIC_API_KEY||(console.error("Gemini API key is missing. The Tea House feature is disabled."),g(!0),l("error"))},[]);let j=(0,o.useCallback)(()=>{v.current&&(v.current.then(e=>e.close()),v.current=null),x.current&&(x.current.getTracks().forEach(e=>e.stop()),x.current=null),w.current&&(w.current.disconnect(),w.current=null),y.current&&"closed"!==y.current.state&&y.current.close(),b.forEach(e=>e.stop()),b.clear(),l("disconnected")},[b]),C=async()=>{if(!m&&!v.current){l("connecting");try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert("Your browser does not support audio recording."),l("error");return}x.current=await navigator.mediaDevices.getUserMedia({audio:!0});let e=new GoogleGenAI({apiKey:d.env.NEXT_PUBLIC_API_KEY}),t=new(window.AudioContext||window.webkitAudioContext)({sampleRate:16e3});y.current=t;let r=new(window.AudioContext||window.webkitAudioContext)({sampleRate:24e3});v.current=e.live.connect({model:"gemini-2.5-flash-native-audio-preview-09-2025",config:{responseModalities:[Modality.AUDIO],inputAudioTranscription:{},outputAudioTranscription:{},systemInstruction:"You are a friendly and knowledgeable host at a digital Iraqi tea house (Diwan). Your goal is to foster positive and engaging conversations about civic life, community, and the future. Keep your responses concise, warm, and encouraging. Your name is Naseem."},callbacks:{onopen:()=>{l("connected");let e=t.createMediaStreamSource(x.current),r=t.createScriptProcessor(4096,1,1);w.current=r,r.onaudioprocess=e=>{var t;let r=e.inputBuffer.getChannelData(0),n=function(e){let t=e.length,r=new Int16Array(t);for(let n=0;n<t;n++)r[n]=32768*e[n];return{data:function(e){let t="",r=e.byteLength;for(let n=0;n<r;n++)t+=String.fromCharCode(e[n]);return btoa(t)}(new Uint8Array(r.buffer)),mimeType:"audio/pcm;rate=16000"}}(r);null===(t=v.current)||void 0===t||t.then(e=>{e.sendRealtimeInput({media:n})})},e.connect(r),r.connect(t.destination)},onmessage:async e=>{var t,n,o,i,a,s;if(null===(t=e.serverContent)||void 0===t?void 0:t.inputTranscription){let{text:t,isFinal:r}=e.serverContent.inputTranscription;p(e=>{let n=e[e.length-1];return n&&"user"===n.author&&!n.isFinal?[...e.slice(0,-1),{...n,text:t,isFinal:r}]:[...e,{id:Date.now(),text:t,author:"user",isFinal:r}]})}if(null===(n=e.serverContent)||void 0===n?void 0:n.outputTranscription){let{text:t,isFinal:r}=e.serverContent.outputTranscription;p(e=>{let n=e[e.length-1];return n&&"model"===n.author&&!n.isFinal?[...e.slice(0,-1),{...n,text:t,isFinal:r}]:[...e,{id:Date.now(),text:t,author:"model",isFinal:r}]})}if(null===(s=e.serverContent)||void 0===s?void 0:null===(a=s.modelTurn)||void 0===a?void 0:null===(i=a.parts[0])||void 0===i?void 0:null===(o=i.inlineData)||void 0===o?void 0:o.data){let t=e.serverContent.modelTurn.parts[0].inlineData.data;k=Math.max(k,r.currentTime);let n=await f(function(e){let t=atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return n}(t),r,24e3,1),o=r.createBufferSource();o.buffer=n,o.connect(r.destination),o.addEventListener("ended",()=>b.delete(o)),o.start(k),k+=n.duration,b.add(o)}},onerror:e=>{console.error("Session error:",e),l("error"),j()},onclose:e=>{j()}}})}catch(e){console.error("Failed to start session:",e),l("error"),j()}}};(0,o.useEffect)(()=>()=>{j()},[j]);let T="connected"===r||"connecting"===r,E={disconnected:{text:t.page.teahouse.disconnected,color:"bg-gray-500"},connecting:{text:t.page.teahouse.connecting,color:"bg-yellow-500 animate-pulse"},connected:{text:t.page.teahouse.connected,color:"bg-green-500"},error:{text:m?"Service Unavailable":t.page.teahouse.error,color:"bg-red-500"}};return(0,n.jsxs)("div",{className:"container mx-auto max-w-3xl px-4 py-8",children:[(0,n.jsx)(s,{title:t.page.teahouse.title,subtitle:t.page.teahouse.description}),(0,n.jsxs)("div",{className:"relative overflow-hidden rounded-2xl bg-white p-6 shadow-xl dark:bg-gray-800",children:[(0,n.jsx)("div",{className:"absolute inset-0 -z-0 bg-gradient-to-br from-gray-50 via-white to-gray-100 dark:from-gray-900/50 dark:via-gray-800 dark:to-gray-900/30"}),(0,n.jsxs)("div",{className:"relative z-10",children:[(0,n.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"h-3 w-3 rounded-full ".concat(E[r].color)}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:E[r].text})]}),"connected"===r&&(0,n.jsx)("p",{className:"animate-pulse text-sm text-green-600 dark:text-green-400",children:t.page.teahouse.speakNow})]}),(0,n.jsx)("div",{className:"scrollbar-hide mb-6 h-80 space-y-4 overflow-y-auto rounded-lg bg-gray-50 p-4 dark:bg-gray-900/50",children:(0,n.jsx)(i.M,{children:h.map(e=>(0,n.jsx)(a.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},layout:!0,className:"flex ".concat("user"===e.author?"justify-end":"justify-start"),children:(0,n.jsx)("div",{className:"max-w-xs rounded-2xl px-4 py-2 md:max-w-md ".concat("user"===e.author?"rounded-br-none bg-green-100 dark:bg-green-900/50":"rounded-bl-none bg-gray-200 dark:bg-gray-700"),children:(0,n.jsx)("p",{className:"text-gray-800 dark:text-gray-200 ".concat(e.isFinal?"":"opacity-70"),children:e.text})})},e.id))})}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsxs)(a.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:T?j:C,className:"flex items-center gap-3 rounded-full px-8 py-4 font-bold text-white transition-all disabled:cursor-not-allowed disabled:bg-gray-400 disabled:shadow-none ".concat(T?"bg-red-600 hover:bg-red-700 shadow-[0_0_20px_theme(colors.red.400)]":"bg-green-600 hover:bg-green-700 shadow-lg"),animate:T?{scale:[1,1.05,1]}:{},transition:T?{repeat:1/0,duration:2,ease:"easeInOut"}:{},disabled:"connecting"===r||m,children:[T?(0,n.jsx)(c,{}):(0,n.jsx)(u,{}),(0,n.jsx)("span",{children:T?t.page.teahouse.leave:t.page.teahouse.join})]})})]})]})]})}},79205:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(2265);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),a=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},l=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:u="",children:d,iconNode:f,...h}=e;return(0,n.createElement)("svg",{ref:t,...c,width:o,height:o,stroke:r,strokeWidth:a?24*Number(i)/Number(o):i,className:s("lucide",u),...!d&&!l(h)&&{"aria-hidden":"true"},...h},[...f.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,n.forwardRef)((r,i)=>{let{className:l,...c}=r;return(0,n.createElement)(u,{ref:i,iconNode:t,className:s("lucide-".concat(o(a(e))),"lucide-".concat(e),l),...c})});return r.displayName=a(e),r}},40257:function(e,t,r){"use strict";var n,o;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(o=r.g.process)?void 0:o.env)?r.g.process:r(44227)},44227:function(e){!function(){var t={229:function(e){var t,r,n,o=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l=[],c=!1,u=-1;function d(){c&&n&&(c=!1,n.length?l=n.concat(l):u=-1,l.length&&f())}function f(){if(!c){var e=s(d);c=!0;for(var t=l.length;t;){for(n=l,l=[];++u<t;)n&&n[u].run();u=-1,t=l.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new h(e,t)),1!==l.length||c||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}},a=!0;try{t[e](i,i.exports,n),a=!1}finally{a&&delete r[e]}return i.exports}n.ab="//";var o=n(229);e.exports=o}()},48614:function(e,t,r){"use strict";r.d(t,{M:function(){return v}});var n=r(57437),o=r(2265),i=r(58881),a=r(53576),s=r(64252),l=r(45750);class c extends o.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:r}=e,i=(0,o.useId)(),a=(0,o.useRef)(null),s=(0,o.useRef)({width:0,height:0,top:0,left:0}),{nonce:u}=(0,o.useContext)(l._);return(0,o.useInsertionEffect)(()=>{let{width:e,height:t,top:n,left:o}=s.current;if(r||!a.current||!e||!t)return;a.current.dataset.motionPopId=i;let l=document.createElement("style");return u&&(l.nonce=u),document.head.appendChild(l),l.sheet&&l.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(n,"px !important;\n            left: ").concat(o,"px !important;\n          }\n        ")),()=>{document.head.removeChild(l)}},[r]),(0,n.jsx)(c,{isPresent:r,childRef:a,sizeRef:s,children:o.cloneElement(t,{ref:a})})}let d=e=>{let{children:t,initial:r,isPresent:i,onExitComplete:l,custom:c,presenceAffectsLayout:d,mode:h}=e,p=(0,a.h)(f),m=(0,o.useId)(),g=(0,o.useCallback)(e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;l&&l()},[p,l]),v=(0,o.useMemo)(()=>({id:m,initial:r,isPresent:i,custom:c,onExitComplete:g,register:e=>(p.set(e,!1),()=>p.delete(e))}),d?[Math.random(),g]:[i,g]);return(0,o.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[i]),o.useEffect(()=>{i||p.size||!l||l()},[i]),"popLayout"===h&&(t=(0,n.jsx)(u,{isPresent:i,children:t})),(0,n.jsx)(s.O.Provider,{value:v,children:t})};function f(){return new Map}var h=r(49637);let p=e=>e.key||"";function m(e){let t=[];return o.Children.forEach(e,e=>{(0,o.isValidElement)(e)&&t.push(e)}),t}var g=r(11534);let v=e=>{let{children:t,custom:r,initial:s=!0,onExitComplete:l,presenceAffectsLayout:c=!0,mode:u="sync",propagate:f=!1}=e,[v,x]=(0,h.oO)(f),y=(0,o.useMemo)(()=>m(t),[t]),w=f&&!v?[]:y.map(p),b=(0,o.useRef)(!0),k=(0,o.useRef)(y),j=(0,a.h)(()=>new Map),[C,T]=(0,o.useState)(y),[E,N]=(0,o.useState)(y);(0,g.L)(()=>{b.current=!1,k.current=y;for(let e=0;e<E.length;e++){let t=p(E[e]);w.includes(t)?j.delete(t):!0!==j.get(t)&&j.set(t,!1)}},[E,w.length,w.join("-")]);let A=[];if(y!==C){let e=[...y];for(let t=0;t<E.length;t++){let r=E[t],n=p(r);w.includes(n)||(e.splice(t,0,r),A.push(r))}"wait"===u&&A.length&&(e=A),N(m(e)),T(y);return}let{forceRender:M}=(0,o.useContext)(i.p);return(0,n.jsx)(n.Fragment,{children:E.map(e=>{let t=p(e),o=(!f||!!v)&&(y===E||w.includes(t));return(0,n.jsx)(d,{isPresent:o,initial:(!b.current||!!s)&&void 0,custom:o?void 0:r,presenceAffectsLayout:c,mode:u,onExitComplete:o?void 0:()=>{if(!j.has(t))return;j.set(t,!0);let e=!0;j.forEach(t=>{t||(e=!1)}),e&&(null==M||M(),N(k.current),f&&(null==x||x()),l&&l())},children:e},t)})})}}},function(e){e.O(0,[521,971,117,744],function(){return e(e.s=32595)}),_N_E=e.O()}]);